---
import BaseLayout from '../layouts/BaseLayout.astro';

const serviceCategories = [
  {
    name: 'Asesoría Tributaria SRI',
    icon: 'fas fa-file-invoice-dollar',
    description: 'Gestión completa de obligaciones tributarias ante el SRI para personas naturales y jurídicas en Ecuador',
    color: 'from-blue-500 to-blue-600',
    services: [
      {
        name: 'Declaraciones de Impuesto a la Renta (IR)',
        description: 'Cálculo y presentación anual del impuesto que grava los ingresos de personas naturales y sociedades.',
        price: 45,
        duration: 'Anual',
        icon: 'fas fa-file-invoice',
        image: 'https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Declaraciones de Impuesto a la Renta. ¿Podrían darme más información?'
      },
      {
        name: 'Declaraciones de IVA',
        description: 'Cálculo y presentación mensual o semestral del Impuesto al Valor Agregado.',
        price: 15,
        duration: 'Mensual/Semestral',
        icon: 'fas fa-percentage',
        image: 'https://images.unsplash.com/photo-1554224155-6726b3ff858f?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Declaraciones de IVA. ¿Podrían darme más información?'
      },
      {
        name: 'Declaración de Retenciones En la Fuente IR',
        description: 'Reporte mensual de las retenciones del Impuesto a la Renta efectuadas.',
        price: 20,
        duration: 'Mensual',
        icon: 'fas fa-hand-holding-usd',
        image: 'https://images.unsplash.com/photo-1434626881859-194d67b2b86f?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Declaración de Retenciones en la Fuente. ¿Podrían darme más información?'
      },
      {
        name: 'Declaración Patrimonial',
        description: 'Presentación obligatoria para personas naturales que superan un monto específico de patrimonio.',
        price: 80,
        duration: 'Anual',
        icon: 'fas fa-landmark',
        image: 'https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Declaración Patrimonial. ¿Podrían darme más información?'
      },
      {
        name: 'Anexo de Gastos Personales',
        description: 'Reporte y proyección de gastos deducibles (vivienda, salud, alimentación, etc.) para la reducción del IR personal.',
        price: 25,
        duration: 'Anual',
        icon: 'fas fa-receipt',
        image: 'https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Anexo de Gastos Personales. ¿Podrían darme más información?'
      },
      {
        name: 'Anexo Transaccional (ATS)',
        description: 'Reporte mensual o semestral de todas las transacciones de compras y ventas.',
        price: 30,
        duration: 'Mensual/Semestral',
        icon: 'fas fa-exchange-alt',
        image: 'https://images.unsplash.com/photo-1450101499163-c8848c66ca85?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Anexo Transaccional (ATS). ¿Podrían darme más información?'
      },
      {
        name: 'Anexo REDEP / Dividendo / REBEFICS',
        description: 'Reportes especializados para retenciones a dependientes, dividendos y beneficiarios efectivos.',
        price: 50,
        duration: 'Según requerimiento',
        icon: 'fas fa-file-contract',
        image: 'https://images.unsplash.com/photo-1507679799987-c73779587ccf?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Anexos REDEP/Dividendo/REBEFICS. ¿Podrían darme más información?'
      },
      {
        name: 'Devolución de IR / IVA Adultos Mayores',
        description: 'Solicitud formal al SRI para recuperar el Impuesto a la Renta pagado en exceso o el IVA pagado por adultos mayores.',
        price: 60,
        duration: 'Por solicitud',
        icon: 'fas fa-undo-alt',
        image: 'https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Devolución de IR/IVA para Adultos Mayores. ¿Podrían darme más información?'
      },
      {
        name: 'Informe de Cumplimiento Tributario (ICT)',
        description: 'Emisión de reporte de auditoría sobre el cumplimiento de obligaciones tributarias (para grandes contribuyentes).',
        price: 300,
        duration: 'Anual',
        icon: 'fas fa-clipboard-check',
        image: 'https://images.unsplash.com/photo-1590283603385-17ffb3a7f29f?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Informe de Cumplimiento Tributario (ICT). ¿Podrían darme más información?'
      },
      {
        name: 'Proyección de Gastos',
        description: 'Estimación anual de gastos personales para cálculo de retenciones del Impuesto a la Renta.',
        price: 35,
        duration: 'Anual',
        icon: 'fas fa-chart-line',
        image: 'https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Proyección de Gastos. ¿Podrían darme más información?'
      }
    ]
  },
  {
    name: 'Gestión Laboral IESS',
    icon: 'fas fa-users',
    description: 'Administración integral de recursos humanos, nómina y seguridad social empresarial',
    color: 'from-green-500 to-green-600',
    services: [
      {
        name: 'Roles de Pago (Nómina)',
        description: 'Elaboración mensual de nóminas, incluyendo remuneración, descuentos y aportes al IESS.',
        price: 35,
        duration: 'Mensual',
        icon: 'fas fa-money-check-alt',
        image: 'https://images.unsplash.com/photo-1554224155-6726b3ff858f?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Roles de Pago (Nómina). ¿Podrían darme más información?'
      },
      {
        name: 'Aviso de Entrada / Avisos de Salida (IESS)',
        description: 'Registro obligatorio ante el IESS de la afiliación o desvinculación de un empleado.',
        price: 15,
        duration: 'Por evento',
        icon: 'fas fa-user-plus',
        image: 'https://images.unsplash.com/photo-1521791136064-7986c2920216?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Avisos IESS (Entrada/Salida). ¿Podrían darme más información?'
      },
      {
        name: 'Contratos / Actas de Finiquito',
        description: 'Asistencia en la elaboración y registro de contratos y liquidación final de valores al término de la relación laboral (Ministerio del Trabajo).',
        price: 40,
        duration: 'Por documento',
        icon: 'fas fa-file-signature',
        image: 'https://images.unsplash.com/photo-1450101499163-c8848c66ca85?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Contratos/Actas de Finiquito. ¿Podrían darme más información?'
      },
      {
        name: 'XIII Sueldo / XIV Sueldo / Utilidades',
        description: 'Cálculo, registro y pago de las remuneraciones y beneficios sociales adicionales obligatorios.',
        price: 30,
        duration: 'Semestral/Anual',
        icon: 'fas fa-gift',
        image: 'https://images.unsplash.com/photo-1579621970563-ebec7560ff3e?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de cálculo de Décimos y Utilidades. ¿Podrían darme más información?'
      },
      {
        name: 'Préstamos Hipotecarios / Quirografarios (IESS)',
        description: 'Asesoría y gestión para acceder a créditos del Banco del IESS (BIESS).',
        price: 80,
        duration: 'Por solicitud',
        icon: 'fas fa-home',
        image: 'https://images.unsplash.com/photo-1560520653-9e0e4c89eb11?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de asesoría para Préstamos IESS. ¿Podrían darme más información?'
      }
    ]
  },
  {
    name: 'Estados Financieros y Reportes',
    icon: 'fas fa-chart-line',
    description: 'Elaboración de estados financieros bajo NIIF y documentación societaria para la Superintendencia de Compañías',
    color: 'from-orange-500 to-orange-600',
    services: [
      {
        name: 'Estados Financieros Bajo NIIF',
        description: 'Elaboración del conjunto completo de estados financieros bajo Normas Internacionales de Información Financiera para garantizar transparencia y comparabilidad.',
        price: 250,
        duration: 'Anual',
        icon: 'fas fa-file-invoice-dollar',
        image: 'https://images.unsplash.com/photo-1590283603385-17ffb3a7f29f?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Estados Financieros bajo NIIF. ¿Podrían darme más información?'
      },
      {
        name: 'Elaboración Estado de Pérdidas y Ganancias',
        description: 'Documento que muestra el desempeño financiero (ingresos y gastos) para determinar la utilidad o pérdida.',
        price: 120,
        duration: 'Mensual/Anual',
        icon: 'fas fa-chart-bar',
        image: 'https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Estado de Pérdidas y Ganancias. ¿Podrían darme más información?'
      },
      {
        name: 'Estado de Flujos de Efectivo / Cambios en el Patrimonio',
        description: 'Reportes que detallan el movimiento del efectivo y las variaciones en las cuentas de patrimonio.',
        price: 100,
        duration: 'Anual',
        icon: 'fas fa-exchange-alt',
        image: 'https://images.unsplash.com/photo-1554224154-26032ffc0d07?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Estado de Flujos de Efectivo. ¿Podrían darme más información?'
      },
      {
        name: 'Notas Explicativas',
        description: 'Información adicional que acompaña a los estados financieros para detallar políticas contables y desglosar saldos.',
        price: 80,
        duration: 'Anual',
        icon: 'fas fa-sticky-note',
        image: 'https://images.unsplash.com/photo-1586281380349-632531db7ed4?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Notas Explicativas. ¿Podrían darme más información?'
      },
      {
        name: 'Actas de Junta / Informes de Gerencia / Comisario',
        description: 'Elaboración, registro y presentación de la documentación legal obligatoria ante la Superintendencia de Compañías.',
        price: 150,
        duration: 'Anual',
        icon: 'fas fa-book',
        image: 'https://images.unsplash.com/photo-1507679799987-c73779587ccf?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Actas e Informes para Superintendencia de Compañías. ¿Podrían darme más información?'
      }
    ]
  },
  {
    name: 'Otros Trámites y Gestiones',
    icon: 'fas fa-tasks',
    description: 'Servicios adicionales para la gestión administrativa y operativa de tu negocio',
    color: 'from-purple-500 to-purple-600',
    services: [
      {
        name: 'Solicitud de Documentos Electrónicos / Preimpresos',
        description: 'Gestiones ante el SRI para la autorización y uso de comprobantes de venta.',
        price: 25,
        duration: 'Por solicitud',
        icon: 'fas fa-file-invoice',
        image: 'https://images.unsplash.com/photo-1554224154-22dec7ec8818?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Solicitud de Documentos Electrónicos. ¿Podrían darme más información?'
      },
      {
        name: 'Solicitud Firma Electrónica',
        description: 'Trámite para obtener el certificado digital para la firma de documentos y declaraciones en línea.',
        price: 80,
        duration: 'Por solicitud',
        icon: 'fas fa-signature',
        image: 'https://images.unsplash.com/photo-1450101499163-c8848c66ca85?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Firma Electrónica. ¿Podrían darme más información?'
      },
      {
        name: 'Toma física de Inventarios y Activos Fijos',
        description: 'Conteo y verificación física de existencias y bienes de larga duración para cotejar con registros contables.',
        price: 180,
        duration: 'Por evento',
        icon: 'fas fa-boxes',
        image: 'https://images.unsplash.com/photo-1553413077-190dd305871c?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Toma física de Inventarios. ¿Podrían darme más información?'
      },
      {
        name: 'Apertura de RUC',
        description: 'Trámites para la obtención del Registro Único de Contribuyentes ante el SRI.',
        price: 40,
        duration: 'Por solicitud',
        icon: 'fas fa-id-card',
        image: 'https://images.unsplash.com/photo-1450101499163-c8848c66ca85?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Apertura de RUC. ¿Podrían darme más información?'
      },
      {
        name: 'Sistema de Facturación',
        description: 'Asesoría o implementación de un sistema para la emisión de comprobantes de venta electrónicos.',
        price: 120,
        duration: 'Por implementación',
        icon: 'fas fa-laptop-code',
        image: 'https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=800&auto=format&fit=crop&q=80',
        whatsappText: 'Hola! Me interesa el servicio de Sistema de Facturación. ¿Podrían darme más información?'
      }
    ]
  }
];

function getGridClasses(servicesCount) {
  // Siempre usar grid de 4 columnas en desktop
  return "grid-cols-1 md:grid-cols-2 lg:grid-cols-4";
}

function getCardSpanClass(servicesCount, index) {
  // Si el número de servicios no es divisible por 4, los últimos elementos se extienden
  const remainder = servicesCount % 4;

  if (remainder === 0) return ""; // Grid completo, sin extensión

  // Calcular si este elemento está en la última fila incompleta
  const isInLastRow = index >= servicesCount - remainder;

  if (!isInLastRow) return "";

  // Extender elementos de la última fila
  if (remainder === 1) {
    return "lg:col-span-4"; // 1 elemento ocupa las 4 columnas
  } else if (remainder === 2) {
    return "lg:col-span-2"; // 2 elementos ocupan 2 columnas cada uno
  } else if (remainder === 3) {
    // 3 elementos: calcular cuál debe extenderse
    const positionInRow = index - (servicesCount - remainder);
    if (positionInRow === 1) {
      return "lg:col-span-2"; // El del medio ocupa 2 columnas
    }
    return ""; // Los de los extremos ocupan 1 columna
  }

  return "";
}
---

<BaseLayout
    title="Servicios Contables Profesionales en Cuenca Ecuador | Contalogic"
    description="Servicios contables profesionales en Cuenca Ecuador. Asesoría tributaria SRI, gestión laboral IESS, estados financieros NIIF, y más. Contadora profesional certificada."
>

  <style>
    .service-card {
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      transform-style: preserve-3d;
    }

    .service-card:hover {
      transform: translateY(-12px) rotateX(5deg);
      box-shadow: 0 25px 60px -12px rgba(0, 0, 0, 0.25);
    }

    .service-image {
      transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .service-card:hover .service-image {
      transform: scale(1.1);
    }

    .price-badge {
      backdrop-filter: blur(6px);
      background: rgba(255, 255, 255, 0.85);
      border: 1px solid rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
      opacity: 0.7;
    }

    .price-badge:hover {
      opacity: 1;
      transform: scale(1.05);
    }

    .category-header {
      animation: fadeInUp 0.8s ease-out;
    }

    .service-card-animate {
      opacity: 0;
      transform: translateY(30px);
      animation: slideInUp 0.6s ease-out forwards;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .btn-primary {
      background: linear-gradient(135deg, #0ea5e9, #0284c7);
      border: none;
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #0284c7, #0369a1);
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(14, 165, 233, 0.4);
    }

    .btn-whatsapp {
      transition: all 0.3s ease;
    }

    .btn-whatsapp:hover {
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 10px 25px rgba(34, 197, 94, 0.4);
    }

    .gradient-bg {
      background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    }

    .modal-backdrop {
      backdrop-filter: blur(8px);
      background: rgba(0, 0, 0, 0.6);
    }

    .modal-content {
      backdrop-filter: blur(20px);
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }

    .show-price {
      opacity: 1 !important;
    }
  </style>

  <!-- Hero Section -->
  <section class="py-20 lg:py-32 gradient-bg">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center category-header">
        <div class="inline-flex items-center px-6 py-3 bg-blue-100 text-blue-700 rounded-full text-sm font-medium mb-8 shadow-sm">
          <i class="fas fa-briefcase mr-2"></i>
          Servicios Contables Profesionales en Ecuador
        </div>
        <h1 class="text-4xl lg:text-6xl font-bold text-gray-900 mb-6">
          Servicios <span class="bg-gradient-to-r from-blue-600 to-blue-800 bg-clip-text text-transparent">contables</span> especializados
        </h1>
        <p class="text-xl text-gray-600 max-w-3xl mx-auto mb-10">
          Descubre mi amplia gama de servicios de asesoría contable y tributaria
          diseñados específicamente para empresas en Ecuador.
        </p>
        <a href="#servicios" class="inline-flex items-center px-8 py-4 btn-primary text-white font-semibold rounded-2xl shadow-lg">
          Explorar servicios
          <i class="fas fa-arrow-down ml-3"></i>
        </a>
      </div>
    </div>
  </section>

  <!-- Services Categories -->
  <section id="servicios" class="py-20 lg:py-32 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      {serviceCategories.map((category, categoryIndex) => (
          <div class={`mb-24 ${categoryIndex !== serviceCategories.length - 1 ? 'border-b border-gray-100 pb-24' : ''}`}>
            <!-- Category Header -->
            <div class="text-center mb-16 category-header">
              <div class={`w-24 h-24 bg-gradient-to-br ${category.color} rounded-3xl flex items-center justify-center mx-auto mb-8 shadow-xl`}>
                <i class={`${category.icon} text-white text-4xl`}></i>
              </div>
              <h2 class="text-3xl lg:text-5xl font-bold text-gray-900 mb-6">
                {category.name}
              </h2>
              <p class="text-xl text-gray-600 max-w-3xl mx-auto mb-4">{category.description}</p>
              <div class="inline-flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-full text-sm font-medium">
                <i class="fas fa-map-marker-alt mr-2"></i>
                Disponible en Cuenca, Ecuador
              </div>
            </div>

            <!-- Services Grid -->
            <div class={`grid gap-8 ${getGridClasses(category.services.length)}`}>
              {category.services.map((service, serviceIndex) => {
                const spanClass = getCardSpanClass(category.services.length, serviceIndex);
                const isWideCard = spanClass.includes('col-span-4');

                return isWideCard ? (
                  // Diseño horizontal para tarjetas anchas
                  <div class={`service-card bg-white rounded-3xl shadow-xl border border-gray-100 overflow-hidden service-card-animate ${spanClass}`} style={`animation-delay: ${serviceIndex * 0.15}s`}>
                    <div class="grid grid-cols-1 lg:grid-cols-2 h-full">
                      <!-- Service Image -->
                      <div class="relative h-64 lg:h-full overflow-hidden group">
                        <img src={service.image} alt={`${service.name} - Cuenca Ecuador`} class="service-image w-full h-full object-cover">
                        <div class="absolute inset-0 bg-gradient-to-t lg:bg-gradient-to-r from-black/60 via-black/20 to-transparent"></div>

                        <!-- Category Icon -->
                        <div class={`absolute top-4 left-4 w-16 h-16 bg-gradient-to-br ${category.color} rounded-2xl flex items-center justify-center shadow-lg`}>
                          <i class={`${service.icon} text-white text-2xl`}></i>
                        </div>
                      </div>

                      <!-- Service Content - Diseño expandido -->
                      <div class="p-8 lg:p-10 flex flex-col justify-center space-y-6">
                        <div>
                          <h3 class="text-2xl lg:text-3xl font-bold text-gray-900 mb-4">{service.name}</h3>
                          <p class="text-gray-600 leading-relaxed text-base lg:text-lg mb-6">{service.description}</p>
                        </div>

                        <!-- Service Details -->
                        <div class="flex flex-wrap items-center gap-4">
                          <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-clock mr-2 text-lg"></i>
                            <span class="font-medium">{service.duration}</span>
                          </div>
                          <div class={`px-4 py-2 bg-gradient-to-r ${category.color} text-white rounded-full text-sm font-semibold shadow-md`}>
                            Disponible ahora
                          </div>
                        </div>

                        <!-- CTA Buttons - Más prominentes -->
                        <div class="flex flex-col sm:flex-row gap-4 pt-4">
                          <button
                              class={`btn-whatsapp flex-1 bg-gradient-to-r ${category.color} text-white py-4 px-6 rounded-xl font-bold shadow-lg flex items-center justify-center text-base whatsapp-btn`}
                              data-message={service.whatsappText}>
                            <i class="fab fa-whatsapp mr-3 text-xl"></i>
                            Solicitar este servicio
                          </button>
                          <button
                              class="info-btn px-6 py-4 border-2 border-gray-300 text-gray-700 rounded-xl hover:border-blue-400 hover:text-blue-600 transition-all duration-300 hover:shadow-lg font-semibold"
                              data-name={service.name}
                              data-description={service.description}
                              data-price={service.price}
                              data-image={service.image}
                              data-message={service.whatsappText}>
                            <i class="fas fa-info-circle mr-2"></i>
                            Más detalles
                          </button>
                        </div>

                        <!-- Características adicionales -->
                        <div class="flex items-center gap-2 text-sm text-gray-500 pt-2 border-t border-gray-100">
                          <i class="fas fa-shield-check text-green-500"></i>
                          <span>Servicio profesional garantizado</span>
                        </div>
                      </div>
                    </div>
                  </div>
                ) : (
                  // Diseño vertical estándar para tarjetas normales
                  <div class={`service-card bg-white rounded-3xl p-0 shadow-xl border border-gray-100 overflow-hidden service-card-animate ${spanClass}`} style={`animation-delay: ${serviceIndex * 0.15}s`}>
                    <!-- Service Image -->
                    <div class="relative w-full h-48 overflow-hidden group">
                      <img src={service.image} alt={`${service.name} - Cuenca Ecuador`} class="service-image w-full h-full object-cover">
                      <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"></div>

                      <!-- Category Icon -->
                      <div class={`absolute top-4 left-4 w-12 h-12 bg-gradient-to-br ${category.color} rounded-xl flex items-center justify-center shadow-lg`}>
                        <i class={`${service.icon} text-white text-lg`}></i>
                      </div>

                      <!-- Service Title Overlay -->
                      <div class="absolute bottom-4 left-4 right-4 text-white">
                        <h3 class="text-lg font-bold leading-tight">{service.name}</h3>
                      </div>
                    </div>

                    <!-- Service Content -->
                    <div class="p-6 space-y-4">
                      <div>
                        <p class="text-gray-600 leading-relaxed text-sm mb-4">{service.description}</p>

                        <!-- Service Details -->
                        <div class="flex items-center justify-between py-3 px-4 bg-gray-50 rounded-xl">
                          <div class="flex items-center text-xs text-gray-500">
                            <i class="fas fa-clock mr-2"></i>
                            <span>{service.duration}</span>
                          </div>
                          <div class={`px-3 py-1 bg-gradient-to-r ${category.color} text-white rounded-full text-xs font-medium shadow-sm`}>
                            Disponible
                          </div>
                        </div>
                      </div>

                      <!-- CTA Buttons -->
                      <div class="flex gap-3 pt-2">
                        <button
                            class={`btn-whatsapp flex-1 bg-gradient-to-r ${category.color} text-white py-3 px-4 rounded-xl font-semibold shadow-lg flex items-center justify-center text-sm whatsapp-btn`}
                            data-message={service.whatsappText}>
                          <i class="fab fa-whatsapp mr-2"></i>
                          Solicitar
                        </button>
                        <button
                            class="info-btn px-4 py-3 border-2 border-gray-200 text-gray-700 rounded-xl hover:border-blue-300 hover:text-blue-600 transition-all duration-300 hover:shadow-md"
                            data-name={service.name}
                            data-description={service.description}
                            data-price={service.price}
                            data-image={service.image}
                            data-message={service.whatsappText}>
                          <i class="fas fa-info-circle"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
      ))}
    </div>
  </section>

  <!-- Service Modal -->
  <div id="service-modal" class="modal-backdrop fixed inset-0 z-50 hidden flex items-center justify-center p-4">
    <div class="modal-content bg-white rounded-3xl max-w-lg w-full p-0 transform transition-all duration-300 scale-95 opacity-0 overflow-hidden" id="modal-content">
      <div class="relative h-56">
        <img id="modal-image" src="" alt="" class="w-full h-full object-cover">
        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"></div>
        <button id="close-modal" class="absolute top-4 right-4 w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-white/30 transition-colors">
          <i class="fas fa-times text-lg"></i>
        </button>
        <div class="absolute bottom-6 left-6 text-white">
          <h3 id="modal-title" class="text-2xl font-bold mb-2"></h3>
        </div>
      </div>

      <div class="p-8">
        <p id="modal-description" class="text-gray-600 mb-8 leading-relaxed text-lg"></p>

        <div class="space-y-4">
          <button
              id="modal-whatsapp-btn"
              class="w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-4 rounded-xl transition-all duration-300 flex items-center justify-center shadow-lg hover:shadow-xl btn-whatsapp">
            <i class="fab fa-whatsapp mr-3 text-xl"></i>
            Solicitar por WhatsApp
          </button>
          <button
              id="close-modal-btn"
              class="w-full border-2 border-gray-200 text-gray-700 py-3 rounded-xl hover:border-gray-300 transition-colors">
            Cerrar
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- CTA Section -->
  <section class="py-20 bg-gradient-to-br from-blue-600 to-blue-800 text-white">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl lg:text-4xl font-bold mb-6">
        ¿Necesitas asesoría contable personalizada?
      </h2>
      <p class="text-xl text-blue-100 mb-10">
        Ofrezco soluciones de asesoría contable personalizadas para empresas en Cuenca Ecuador.
        Contáctame y te ayudaré a encontrar la mejor opción para tu negocio.
      </p>
      <div class="flex flex-col sm:flex-row gap-6 justify-center">
        <a href="/contacto" class="inline-flex items-center justify-center px-8 py-4 bg-white text-blue-600 font-semibold rounded-2xl hover:bg-gray-50 transition-all duration-300 shadow-lg hover:shadow-xl">
          <i class="fas fa-envelope mr-3"></i>
          Solicitar asesoría personalizada
        </a>
        <button id="whatsapp-general" class="btn-whatsapp inline-flex items-center justify-center px-8 py-4 bg-green-500 text-white font-semibold rounded-2xl hover:bg-green-600 transition-all duration-300 shadow-lg">
          <i class="fab fa-whatsapp mr-3"></i>
          Chat directo
        </button>
      </div>
    </div>
  </section>

  <script>
    // Función para enviar mensaje a WhatsApp
    function sendWhatsAppMessage(message) {
      try {
        const phoneNumber = "593987919930";
        const encodedMessage = encodeURIComponent(message);
        const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodedMessage}`;

        // Abrir en nueva ventana/pestaña sin afectar la página actual
        const newWindow = window.open(whatsappUrl, '_blank', 'noopener,noreferrer,width=800,height=600');

        // Verificar si se abrió correctamente
        if (newWindow && !newWindow.closed) {
          // Todo bien, la ventana se abrió
          console.log('WhatsApp abierto correctamente');
        } else {
          // Fallback: crear un enlace temporal y hacer clic
          const link = document.createElement('a');
          link.href = whatsappUrl;
          link.target = '_blank';
          link.rel = 'noopener noreferrer';
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
        }
      } catch (error) {
        console.error('Error al abrir WhatsApp:', error);
        // Fallback adicional
        window.open(`https://wa.me/593987919930`, '_blank');
      }
    }

    // Función para abrir modal de servicio
    function openServiceModal(title, description, price, image, whatsappText) {
      const modal = document.getElementById('service-modal');
      const content = document.getElementById('modal-content');

      document.getElementById('modal-title').textContent = title;
      document.getElementById('modal-description').textContent = description;
      document.getElementById('modal-image').src = image;

      // Configurar botón de WhatsApp del modal
      const modalWhatsappBtn = document.getElementById('modal-whatsapp-btn');
      modalWhatsappBtn.onclick = () => sendWhatsAppMessage(whatsappText);

      modal.classList.remove('hidden');
      setTimeout(() => {
        content.classList.remove('scale-95', 'opacity-0');
        content.classList.add('scale-100', 'opacity-100');
      }, 10);
    }

    // Función para cerrar modal
    function closeServiceModal() {
      const modal = document.getElementById('service-modal');
      const content = document.getElementById('modal-content');

      content.classList.remove('scale-100', 'opacity-100');
      content.classList.add('scale-95', 'opacity-0');

      setTimeout(() => {
        modal.classList.add('hidden');
      }, 300);
    }

    // Event listeners cuando el DOM esté listo
    document.addEventListener('DOMContentLoaded', function() {
      // Botones de WhatsApp en las tarjetas
      document.querySelectorAll('.whatsapp-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          const message = this.dataset.message;
          if (message) {
            sendWhatsAppMessage(message);
          }
          return false;
        });
      });

      // Botones de información
      document.querySelectorAll('.info-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          const name = this.dataset.name;
          const description = this.dataset.description;
          const price = this.dataset.price;
          const image = this.dataset.image;
          const message = this.dataset.message;

          if (name && description && price && image && message) {
            openServiceModal(name, description, price, image, message);
          }
          return false;
        });
      });

      // Cerrar modal
      document.getElementById('close-modal').addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        closeServiceModal();
        return false;
      });

      document.getElementById('close-modal-btn').addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        closeServiceModal();
        return false;
      });

      // Cerrar modal al hacer clic fuera
      document.getElementById('service-modal').addEventListener('click', function(e) {
        if (e.target === this) {
          e.preventDefault();
          e.stopPropagation();
          closeServiceModal();
          return false;
        }
      });

      // WhatsApp general
      document.getElementById('whatsapp-general').addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        sendWhatsAppMessage('Hola! Me interesa conocer más sobre tus servicios contables. ¿Podrías ayudarme?');
        return false;
      });

      // Intersection Observer para animaciones
      const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.style.animationPlayState = 'running';
          }
        });
      }, observerOptions);

      // Observar tarjetas de servicios
      document.querySelectorAll('.service-card-animate').forEach(el => {
        el.style.animationPlayState = 'paused';
        observer.observe(el);
      });
    });
  </script>

</BaseLayout>
